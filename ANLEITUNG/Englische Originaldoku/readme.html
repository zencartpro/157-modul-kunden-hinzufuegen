<!doctype html>
<html dir="ltr" lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Add Customers From Admin (Zen-Cart&reg; v1.5.7)</title>
<style>
<!--
a, a:active, a:visited {
  color: #006666;
  text-decoration: none
}
a:hover {
    color:#00CC99;
    text-decoration: underline;
}
BODY, P, H1, H2, H3, H4, H5, H6, LI, TD, DD, DT, table, img {
  font-family: Verdana, AvantGarde, Tahoma, Arial, sans-serif;
  font-size: 12px;
  color: black;
  padding: 0px;
  margin: 20px;
}
H1, H2, H3, H4 {
  font-weight: bold;
}
h1 {
  font-size: 20px;
}
h2 {
  font-size: 16px;
  border-top: 1px dashed #000066;
  padding-top: 5px;
  color: #000066;
}
h3 {
  border-top: 1px dotted #3333ff;
  color: #3333ff;
}
img {
    max-width: 95vw;
    height: auto;
}
table { 
  border-collapse: collapse; 
}
th, td {
  border: 1px solid #000066;
  padding: 5px;
  text-align: left;
}
ol li, ul li {
  margin: 0 0 5px;
}
ol li ul li, ul li ul li {
  margin: 0 auto 5px;
}
tr td:first-child {
  font-weight: bold;
  color: #000066;
}
.smaller {
  font-size: 10px;
}
.o {
  background-color: #f4f4f4;
}
-->
</style>
</head>

<body>
<a name="top" id="top"></a>
<h1>Add Customers From Admin for Zen Cart&reg; v1.5.7</h1>
<h3>Version 3.0.0</h3>
<p>Copyright (c) 2012-2021, <a href="https://vinosdefrutastropicales.com">Vinos de Frutas Tropicales</a> (lat9)</p>
<p>Current support thread at Zen Cart Forums: <a href="https://www.zen-cart.com/showthread.php?199629-Add-Customers-from-Admin-2-0-%281-5-0-and-later%29-Support-Thread" target="_blank">www.zen-cart.com/showthread.php?199629-Add-Customers-from-Admin-2-0-%281-5-0-and-later%29-Support-Thread</a>.  This software is provided for your use under the GNU General Public License.</p>

<h2>What it does</h2>
<p>This plugin allows an admin user to add customers manually (or via CSV file bulk upload) to their shop's database, optionally sending each customer a "welcome" email that includes their password.  Once you have installed the plugin (see below), you can access the plugin via your admin's <em>Customers-&gt;Add Customer</em>.  The initial screen for the tool looks like this:</p>
<img src="screenshot.png" title="Sample output" alt="Sample output" />
<p>The top left-hand side of the tool is used to perform a bulk-upload of customers via a Comma-Separated Values (CSV) file, the bottom left-hand side of the tool is used to resend a customer their "Welcome E-Mail" and the right-hand side of the tool is used to enter customers one-by-one.</p>

<h3>Using the CSV Bulk-Upload</h3>
<p>The <em>Bulk Upload</em> feature allows you to create a CSV file on another computer and then <em>Upload</em> that file to perform a "Bulk Upload" of customers into your database. That file's format is described by <a href="add_customers_formatting_csv.html" target="_blank">add_customers_formatting_csv.html</a> <span class="smaller">(opens in a new window)</span>.</p>
<p>Before you choose your upload file, choose the <em>Insert Mode</em>; this mode tells the tool what to do if errors are present in the file's data:</p>
<ul>
  <li><strong>Part (Insert Valid Lines):</strong> If a CSV line/record is error-free, that customer entry will be created; all errors will be flagged so that you can correct the problem, but the customer entry is not created in the database.</li>
  <li><strong>File (Require the Whole File to be Valid):</strong> Only if there are no errors present in the file are all the customer records added; any errors are flagged by line-number so that you can correct the problems.</li>
</ul>
<p>Next, choose the format to be applied to the <b>dob</b> fields present in the uploaded file.  Choose from one of the drop-down menu selections: YYYY/MM/DD, MM/DD/YYYY, YYYY-MM-DD, MM-DD-YYYY, YYYY/DD/MM, DD/MM/YYYY, YYYY-DD-MM, or DD-MM-YYYY.</p>

<h3>Resend the "Welcome E-Mail"</h3>
<p>Use this part of the tool to re-send the selected customer their "Welcome E-Mail", optionally resetting their login password at the same time.  Choose a customer from the drop-down list of all customers <em>who have not yet logged into your store</em>, optionally checking the box to reset their login password and then click "Resend".</p>
<p><strong>Note:</strong> If all registered customers have previously logged into your store, the drop-down box will contain only "Please Choose" and no customer-selection will be possible.</p>

<h3>Entering Customers One-by-One</h3>
<p>Use this part of the tool if you only have a few customers to add.  Many of the fields' values are/are not displayed based on your admin's <strong>Configuration</strong> settings as are the minimum acceptable values.  In each case, the table below describes which <strong>Configuration</strong> settings control the field &hellip; and how.</p>
<table>
  <tr class="tHead o">
    <th>Field Name</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>Customers Authorization Status</td>
    <td>Choose a value from the drop-down menu.</td>
  </tr>
  <tr class="o">
    <td>Gender</td>
    <td>If <em>Customer Details-&gt;Email Salutation</em> is set to <em>true</em>, the value is displayed and you must choose one of the <em>Male</em> or <em>Female</em> radio buttons; otherwise, the field is not displayed and the default database value is used.</td>
  </tr>
  <tr>
    <td>First Name</td>
    <td>This field is always displayed.  Its minimum acceptable length is controlled by <em>Minimum Values-&gt;First Name</em>; if that value is 0, this field's value is optional.</td>
  </tr>
  <tr class="o">
    <td>Last Name</td>
    <td>This field is always displayed.  Its minimum acceptable length is controlled by <em>Minimum Values-&gt;Last Name</em>; if that value is 0, this field's value is optional.</td>
  </tr>
  <tr>
    <td>Date of Birth</td>
    <td>If <em>Customer Details-&gt;Date of Birth</em> is set to <em>true</em>, this field is displayed along with the "Date of Birth Format" drop-down menu.  The default format is based on the defined value DATE_FORMAT_SHORT, present in primary language file for your admin's active language selection (e.g. /YOUR_ADMIN/includes/languages/english.php) and can be one of YYYY/MM/DD, MM/DD/YYYY, YYYY-MM-DD, MM-DD-YYYY, YYYY/DD/MM, DD/MM/YYYY, YYYY-DD-MM, or DD-MM-YYYY.</td>
  </tr>
  <tr class="o">
    <td>E-Mail Address</td>
    <td>This field is always displayed.  Its minimum acceptable length is controlled by <em>Minimum Values-&gt;Email Address</em>. However, regardless of minimum length, the value must be a "proper" email address and must not already be used by another customer in your database.</td>
  </tr>
  <tr>
    <td>Company</td>
    <td>If <em>Customer Details-&gt;Company</em> is set to <em>true</em>, the value is displayed and its minimum acceptable length is controlled by <em>Minimum Values-&gt;Company</em>; otherwise, the field is not displayed and the default database value is used.</td>
  </tr>
  <tr class="o">
    <td>Street Address</td>
    <td>This field is always displayed.  Its minimum acceptable length is controlled by <em>Minimum Values-&gt;Street Address</em>; if that value is 0, this field's value is optional.</td>
  </tr>
  <tr>
    <td>Suburb</td>
    <td>If <em>Customer Details-&gt;Address Line 2</em> is set to <em>false</em>, this field is not displayed; otherwise, the field is displayed but its value is optional.</td>
  </tr>
  <tr class="o">
    <td>City</td>
    <td>This field is always displayed. Its minimum acceptable length is controlled by <em>Minimum Values-&gt;City</em>; if that value is 0, this field's value is optional.</td>
  </tr>
  <tr>
    <td>Post Code</td>
    <td>This field is always displayed. Its minimum length is controlled by <em>Minimum Values-&gt;Postcode</em>; if that value is 0, this field's value is optional.  In addition, if the "Country" is set to one of Canada, Great Britain, or the United States then the Post Code value is checked for a valid zip/post code in those three countries.</td>
  </tr>
  <tr class="o">
    <td>Country</td>
    <td>This field is always displayed as a drop-down menu that contains all the countries supported by your store.  Choose a value from the drop-down menu; the default value is the one you have selected in <em>Customer Details-&gt;Create Account Default Country ID</em>.<br /><br /><strong>Note:</strong> When you change the "Country", the screen will refresh and the "State" field will be updated for the currently-selected country.</td>
  </tr>
  <tr>
    <td>State</td>
    <td>This field is displayed only if <em>Customer Details-&gt;State</em> is set to <em>true</em>.  If the currently-selected "Country" has zones, this field is displayed as a drop-down menu containing all zones for that country; otherwise, this field is displayed as an input field whose minimum acceptable length is controlled by <em>Minimum Values-&gt;State</em>  (if that value is 0, this field's value is optional).</td>
  </tr>
  <tr class="o">
    <td>Telephone</td>
    <td>This field is always displayed.  Its minimum acceptable length is controlled by <em>Minimum Values-&gt;Telephone Number</em>; if that value is 0, this field's value is optional. If the field's value is not optional, the value entered is also validated as a "world phone number".</td>
  </tr>
  <tr>
    <td>Fax Number</td>
    <td>If <em>Customer Details-&gt;Fax Number</em> is set to <em>true</em>, this field is displayed. This field's value is always optional.</td>
  </tr>
  <tr class="o">
    <td>Email Format Pref</td>
    <td>This field is always displayed.  Choose one of the radio-buttons, either HTML or Text-only; the default selection is based on <em>Customer Details-&gt;Customer Default Email Preference</em>.</td>
  </tr>
  <tr>
    <td>Newsletter</td>
    <td>Specifies whether or not the customer is to be subscribed to the newsletter for your store, either Yes or No; the default selection is controlled by the setting in <em>Configuration-&gt;Customer Details-&gt;Show Newsletter Checkbox</em>.</td>
  </tr>
  <tr class="o">
    <td>Discount Pricing Group</td>
    <td>This field is always displayed.  The drop-down menu contains all discount pricing groups you have created using your admin's <em>Customers-&gt;Group Pricing</em> tool.  If no pricing groups are selected, only one selection ("-none-") will be available.</td>
  </tr>
  <tr>
    <td>Customer Referral 1st Discount Coupon</td>
    <td>This field is displayed only if <em>Customer Details-&gt;Customers Referral Status</em> is set to <em>2</em> (Customer can add during create account or edit if blank); when displayed, the field's value is optional.</td>
  </tr>
  <tr class="o">
    <td>Send this customer the welcome e-mail?</td>
    <td>Check this box if you want the customer you're adding to receive a "Welcome E-Mail" that includes his/her account default password. If <em>GV Coupons-&gt;New Signup Discount Coupon ID#</em> is not set to <em>0 (None)</em>, this e-mail will include the information associated with the discount coupon selected.  If <em>GV Coupons-&gt;New Signup Gift Voucher Amount</em> is set to a non-zero value, a new gift voucher will be created for this customer and this e-mail will include the information associated with this gift voucher.</td>
  </tr>
</table>

<h2>Installation</h2>
<p>There are no core-file overwrites in this plugin, but you should <strong>always</strong> backup your cart's database and files prior to making any changes.</p>
<p>Copy the following files to your cart's installation, after renaming the &quot;YOUR_ADMIN&quot; directory to match your custom admin's name:</p>
<ol>
  <li>/add_customers_formatting_csv.html</li>
  <li>/YOUR_ADMIN/add_customers.php</li>
  <li>/YOUR_ADMIN/includes/classes/addCustomer.php</li>
  <li>/YOUR_ADMIN/includes/extra_datafiles/add_customers_filenames.php</li>
  <li>/YOUR_ADMIN/includes/functions/extra_functions/init_add_customers.php</li>
  <li>/YOUR_ADMIN/includes/languages/english/add_customers.php</li>
  <li>/YOUR_ADMIN/includes/languages/english/extra_definitions/add_customers_name.php</li>
</ol>
<h3>Other Files</h3>
<p>This plugin also includes the following files that should not be copied to your installation:</p>
<ol>
  <li>/add_customers_uninstall.sql<ul><li>Run this file in your admin's <em>Tools-&gt;Install SQL Patches</em> to remove this plugin.</li></ul></li>
  <li>/bad_examples.csv<ul><li>This file contains examples of a CSV file with errors (using the default Zen Cart database settings) so that you can see how the plugin responds in those cases.</li></ul></li>
  <li>/example_addresses.csv<ul><li>This file contains examples of how you can specify customer data in a CSV file for bulk-upload.</li></ul></li>
  <li>/license.txt<ul><li>Contains the GPL license associated with this plugin.</li></ul></li>
  <li>/screenshot.png<ul><li>This file has a screenshot of the <em>Customers-&gt;Add Customer</em> admin screen.</li></ul></li>
</ol>

<h2>Uninstall</h2>
<p>First, delete the files that were copied to your zen-cart installation's admin directories then use your admin's <em>Tools-&gt;Run SQL Patches</em> to run the file <b>add_customers_uninstall.sql</b>.</p>

<h2>Version History:</h2>
<p>This plugin is based on v1.08 of the <a href="https://www.zen-cart.com/downloads.php?do=file&amp;id=454"><em>Add Customers from Admin</em></a> add-on developed for the 1.3.x versions of Zen Cart&reg;, but this version (v3.0.0 and later) has been modified for v1.5.7 and later <em>only</em>.</p>
<ul>
    <li>v3.0.0, 2021-12-13 (lat9):<ul>
        <li>BUGFIX: Correcting various PHP notices, deprecations and warnings.</li>
        <li>CHANGE: The minimum Zen Cart version now supported is v1.5.7.</li>
        <li>CHANGE: <code>/YOUR_ADMIN/add_customers_backend.php</code> is no longer used; see <code>/YOUR_ADMIN/includes/classes/addCustomer.php</code>.</li>
    </ul></li>
    <li>v2.0.9, 2016-04-18 (lat9):<ul>
        <li>BUGFIX: Correct that the &quot;Street Address&quot; and &quot;Newsletter&quot; labels are hidden.</li>
    </ul></li>
    <li>v2.0.8, 2016-01-30 (lat9):<ul>
        <li>BUGFIX: Correct PHP parse error introduced in v2.0.7 into the <code>update_customer</code> function.</li>
        <li>CHANGE: Incorporate additional changes based on create-account handling.</li>
    </ul></li>
    <li>v2.0.7, 2015-12-24 (lat9):<ul>
        <li>BUGFIX: Correct PHP "Notify" issues, check for the presence of each value in the customer-array.</li>
        <li>CHANGE: Update to use, if present, the <code>zen_create_PADSS_password</code> function to generate a more secure temporary password.</li>
    </ul></li>
    <li>v2.0.6, 2013-10-29 (lat9):<ul>
        <li>BUGFIX: Re-fixed v2.0.5's first BUGFIX (errors moving file on upload).  Use DIR_FS_BACKUP for the uploaded file; it's already got the proper settings in the .htaccess for that directory.</li>
    </ul></li>
    <li>v2.0.5, 2013-08-11 (lat9):<ul>
        <li>BUGFIX: Somewhere along the line, the DIR_FS_UPLOADS define got removed from the admin's configure.php file; if it's not defined, define it to point to /images/uploads.</li>
        <li>BUGFIX: <em>customers_group_pricing</em> field was not included as a "bulk upload" column.</li>
    </ul></li>
    <li>v2.0.4, 2013-05-16 (lat9):<ul>
        <li>BUGFIX: Single-customer addition was not honoring the setting in <em>Configuration-&gt;Customer Details-&gt;Show Newsletter Checkbox</em> for the <em>Newsletter</em> default setting.</li>
    </ul></li>
    <li>v2.0.3, 2013-02-18 (lat9):<ul>
        <li>Removed unused/unneeded files /YOUR_ADMIN/includes/functions/init_add_customers.php and /YOUR_ADMIN/add_customers_formatting_csv.html</li>
        <li>BUGFIX: Imported CSV files created/saved using Unix/Macintosh line endings (\r only) were not properly handled.</li>
        <li>BUGFIX: Added detection of empty or header-only imported files.</li>
    </ul></li>
    <li>v2.0.2, 2012-10-26 (lat9):<ul>
        <li>BUGFIX: Access denied error for any admin authorization level other than superuser; changed file is /YOUR_ADMIN/includes/extra_datafiles/add_customers_filenames.php.</li>
    </ul></li>
    <li>v2.0.1, 2012-09-28 (lat9):<ul>
        <li>Updated for v1.5.1 to use zen_create_PADSS_password (if present) to create the added customer's password.  If the function is not present, continues to use zen_create_random_value.  Thanks to <em>lhungil</em> for pointing out the change requirement!</li>
        <li>BUGFIX: Admin copy of email contained EMAIL_TEXT instead of the text.</li>
        <li>BUGFIX: If the Postcode mininum value was set to 0 and the value was not supplied, the insert failed due to invalid postcode format.</li>
        <li>BUGFIX: If a customer has already logged into the store, don't include them in the list to "Resend Welcome Email".  Thanks to <em>lhungil</em> for pointing this out, too!</li>
    </ul></li>
    <li>v2.0.0, 2012-08-31, Initial release (lat9).<ul>
        <li>Moved <em>all</em> language-specific text to the language file. <strong>Note:</strong> Additional defines appear as English within the Czech language files.</li>
        <li>Added auto-install script for v1.5.0+ admin</li>
        <li>If the currently-selected Country has zones, a drop-down menu of associated zones is presented; otherwise, the admin user must enter a "State" value (if required).</li>
        <li>Updated the CSV help text to be more 'robust'</li>
        <li>Added basic validation for world telephone numbers</li>
        <li>Added preg_match validation for US, CA and GB postcodes</li>
        <li>User-selectable formatting for the Date of Birth fields</li>
        <li>All form-related variables (including action) are sent via POST</li>
        <li>BUGFIX: Missing check for required Company field</li>
        <li>BUGFIX: Incorrect check for minimum first-name length</li>
        <li>BUGFIX: Unspecified (i.e. empty) DOB accepted when the DOB is required</li>
        <li>BUGFIX: Non-zero "New Signup Gift Voucher Amount" resulted in a white-screen</li>
        <li>BUGFIX: Address records for countries that have zones were incorrectly created</li>
    </ul></li>
</ul>
</body>
</html>